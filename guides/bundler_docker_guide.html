<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge' http-equiv='X-UA-Compatible'>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    <meta content='276VSYOko8B8vIu1i8i5qbj7_ql5PXo0dU69XQy-SL' name='globalsign-domain-verification'>
    <title>
      Bundler: How to use Bundler with Docker
    </title>
    
    <script src="/javascripts/application.js"></script>
    <script src="/javascripts/analytics.js" async="true"></script>
    <link href="/stylesheets/application.css" rel="stylesheet" />
    <link href='/images/apple-touch-icon.png' rel='apple-touch-icon' sizes='180x180'>
    <link href='/images/favicon-32x32.png' rel='icon' sizes='32x32' type='image/png'>
    <link href='/images/favicon-16x16.png' rel='icon' sizes='16x16' type='image/png'>
    <link href='/manifest.json' rel='manifest'>
    <link color='#50bced' href='/images/safari-pinned-tab.svg' rel='mask-icon'>
    <meta content='bundler.io' name='apple-mobile-web-app-title'>
    <meta content='bundler.io' name='application-name'>
    <meta content='#ffffff' name='theme-color'>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/blog/feed.xml" />
    
  </head>
  <body class=''>
    <nav class='navbar navbar-default'>
      <div class='container'>
        <div class='navbar-header'>
          <button aria-expanded='false' class='navbar-toggle collapsed' data-target='#bs-navbar-collapse' data-toggle='collapse' type='button'>
            <span class='sr-only'>Toggle navigation</span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
            <span class='icon-bar'></span>
          </button>
          <b><a href="/" class="navbar-brand">Bundler</a></b>
        </div>
        <div class='collapse navbar-collapse' id='bs-navbar-collapse'>
          <ul class='nav navbar-nav navbar-right'>
            <li>
              <div class='search-wrapper'>
                <div class='form-group has-feedback'>
                  <i class='glyphicon glyphicon-search form-control-feedback'></i>
                  <input class='input-search' id='input-search' placeholder='Type to search...' type='text'>
                </div>
              </div>
            </li>
            <li><a href="/docs.html">Docs</a></li>
            <li><a href="/contributors.html">Team</a></li>
            <li><a href="/blog">Blog</a></li>
            <li><a href="https://github.com/bundler/bundler">Repository</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <div class='main-wrapper'>
      <div class='row bg-light-blue header'>
        <img src="/images/docs_header_transparent_bg.png" srcset="/images/docs_header_transparent_bg.png 1x, /images/docs_header_transparent_bg@2x.png 2x, /images/docs_header_transparent_bg@3x.png 3x" class="img-responsive header-padding" style="max-width: 400px;" alt="Docs header transparent bg" />
      </div>
      <div class='row'>
        <div class='container' id='guide-container'>
          <div id='wrapper'>
            <div class='hidden-xs' id='sidebar-wrapper'>
              <div class='sidebar-nav'>
                <h4>Guides</h4>
                <ul>
                  <li class=''>
                    <a href="/v1.16/guides/faq.html">Frequently Asked Questions</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/creating_gem.html">How to create a Ruby gem with Bundler</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/deploying.html">How to deploy bundled applications</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/git.html">How to install gems from git repositories</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/using_bundler_in_applications.html">How to manage application dependencies with Bundler</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/groups.html">How to manage groups of gems</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/bundler_sharing.html">How to package and share code using a Gemfile</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/rubygems_tls_ssl_troubleshooting_guide.html">How to troubleshoot RubyGems and Bundler TLS/SSL Issues</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/updating_gems.html">How to update gems with Bundler</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/bundler_in_a_single_file_ruby_script.html">How to use Bundler in a single-file Ruby script</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/bundler_docker_guide.html">How to use Bundler with Docker</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/rails.html">How to use Bundler with Rails</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/bundler_setup.html">How to use Bundler with Ruby</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/sinatra.html">How to use Bundler with Sinatra</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/git_bisect.html">How to use git bisect with Bundler</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                  <li class=''>
                    <a href="/v1.16/guides/bundler_plugins.html">How to write a Bundler plugin</a>
                  </li>
                  <li class='separator'>
                    <hr>
                  </li>
                </ul>
              </div>
            </div>
            <div class='guide contents' id='page-content-wrapper'>
              <h1 id="how-to-use-bundler-with-docker">How to use Bundler with Docker</h1>
              
              <h2 id="introduction">Introduction</h2>
              
              <p>The official Docker images for Ruby assume that you will use only one application, with one Gemfile, and no other gems or Ruby applications will be installed or run in your container.</p>
              
              <p>If you want to install more than one Gemfile in your container, or simply install gems via RubyGems and use them as system gems, this situation is confusing, and has historically led to many confusing errors that appear to be bugs in Bundler.</p>
              
              <p>However, these errors ultimately come from the way the Dockerfile tells Bundler to create <a href="https://bundler.io/v1.16/man/bundle-binstubs.1.html">binstubs</a> (which are linked to one application and Gemfile) in a single global place for the entire container. If you install two Gemfiles with <code>rake</code>, for example, running the <code>rake</code> command will always load the last Gemfile that was installed, and never any others.</p>
              
              <h2 id="dockerfiles-for-multiple-ruby-applications-and-gems">Dockerfiles for multiple Ruby applications and gems</h2>
              
              <p>To build a Docker container that can run more than one Ruby application or global commands installed with <code>gem install</code>, you will need to change some environment variables from the defaults set in the official Docker image for Ruby.</p>
              
              <p>In your Dockerfile, change the <code>PATH</code> and <code>GEM_HOME</code> so that Bundler will install all gems to the same location, and running commands will use the RubyGems binstubs instead of Bundler’s application-locked binstubs:</p>
              
              <div class="highlight"><pre class="highlight plaintext"><code>ENV GEM_HOME="/usr/local/bundle"&#x000A;ENV PATH $GEM_HOME/bin:$GEM_HOME/gems/bin:$PATH&#x000A;</code></pre></div>
              <p>You will also need to unset <code>BUNDLE_PATH</code> and <code>BUNDLE_BIN</code>. Unsetting environment variables can be somewhat tricky in Docker, but the most common way is at the beginning of your <code>ENTRYPOINT</code> script:</p>
              
              <div class="highlight"><pre class="highlight shell"><code><span class="c">#!/bin/bash</span>&#x000A;&#x000A;<span class="nb">unset </span>BUNDLE_PATH&#x000A;<span class="nb">unset </span>BUNDLE_BIN&#x000A;&#x000A;<span class="c"># your script goes here</span>&#x000A;</code></pre></div>
              <p>Once you’ve done that, you’ll be able to run commands without a bundle by calling them directly, like <code>rake</code>. You’ll be able to run commands in a specific bundle by <code>cd</code>ing to that bundle’s directory and then using <code>bundle exec</code>. For example, to run rake inside your application bundle, you would use <code>bundle exec rake</code>.</p>
            </div>
          </div>
        </div>
      </div>
      <div class='row'>
        <div class='container'>
          <div class='hidden-lg hidden-md hidden-sm' id='bottom-sidebar-wrapper'>
            <div class='bottom-sidebar-nav'>
              <ul>
                <li class=''>
                  <a href="/v1.16/guides/faq.html">Frequently Asked Questions</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/creating_gem.html">How to create a Ruby gem with Bundler</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/deploying.html">How to deploy bundled applications</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/git.html">How to install gems from git repositories</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/using_bundler_in_applications.html">How to manage application dependencies with Bundler</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/groups.html">How to manage groups of gems</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/bundler_sharing.html">How to package and share code using a Gemfile</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/rubygems_tls_ssl_troubleshooting_guide.html">How to troubleshoot RubyGems and Bundler TLS/SSL Issues</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/updating_gems.html">How to update gems with Bundler</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/bundler_in_a_single_file_ruby_script.html">How to use Bundler in a single-file Ruby script</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/bundler_docker_guide.html">How to use Bundler with Docker</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/rails.html">How to use Bundler with Rails</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/bundler_setup.html">How to use Bundler with Ruby</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/sinatra.html">How to use Bundler with Sinatra</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/git_bisect.html">How to use git bisect with Bundler</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
                <li class=''>
                  <a href="/v1.16/guides/bundler_plugins.html">How to write a Bundler plugin</a>
                </li>
                <li class='separator'>
                  <hr>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <script>
        $(document).ready(function() {
          anchors.add();
        });
      </script>
      <div class='row bg-light-blue'>
        <div class='container'>
          <div class='contents'>
            <div class='edit-on-github text-center'>
              <a href="https://github.com/bundler/bundler-site/blob/master/source/v1.16/guides/bundler_docker_guide.html.md">Edit this document on GitHub</a> if you caught an error or noticed something was missing.
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class='footer'>
      <div class='row'>
        <div class='container text-center'>
          <ul class='nav navbar-nav'>
            <li><a href="/docs.html">Docs</a></li>
            <li><a href="/contributors.html">Team</a></li>
            <li><a href="/blog">Blog</a></li>
            <li><a href="https://github.com/bundler/bundler">Repository</a></li>
          </ul>
        </div>
      </div>
    </div>
  </body>
</html>
<style>
  .main-wrapper {
    padding-bottom: 0;
  }
</style>
